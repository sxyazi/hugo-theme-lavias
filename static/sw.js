const o="121b5acb",h=t=>{const e=t.split("/").pop()??"";return!!(["favicon.ico","manifest.json"].includes(e)||/.+\.[\da-z]{8}\.(js|json|css)$/.test(e)||/^\/?[^/]+-\d+x\d+\.png$/.test(t))},d=(t,e)=>{if(t.byteLength!==e.byteLength)return!1;const s=new Int8Array(t),r=new Int8Array(e);for(let n=0;n<t.byteLength;n++)if(s[n]!==r[n])return!1;return!0};self.addEventListener("install",t=>{t.waitUntil(self.skipWaiting())});self.addEventListener("activate",t=>{t.waitUntil(async function(){await caches.keys().then(e=>e.filter(s=>s!==o)).then(e=>Promise.all(e.map(s=>caches.delete(s))))}())});const y=new URL(self.registration.scope).hostname;self.addEventListener("fetch",t=>{const{request:e,clientId:s}=t,r=new URL(e.url);if(r.hostname===y)return t.respondWith(async function(){const n=await caches.match(e);if(n&&h(r.pathname))return n;const f=e.headers.get("x-swr")&&(n==null?void 0:n.clone()),l=fetch(e).then(a=>{if(a.status>=400)return a;const u=a.clone();return caches.open(o).then(c=>c.put(e,u)).catch(console.error),f&&a.clone().arrayBuffer().then(async c=>{if(d(c,await f.arrayBuffer()))return;const i=await self.clients.get(s);i==null||i.postMessage({type:"SWR",version:o,path:r.pathname,buf:c},[c])}).catch(console.error),a});return n??l}())});
